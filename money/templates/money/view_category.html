{% extends base %}
{% load i18n %}{% load auth %}

{% block content %}
    <script type="text/javascript">
        function delete_category(id)
        {
            show_dialog(
                {
                    header: "{{ _("Are you sure you want to delete this category?") }}",
                    explanation: "",
                    buttons:
                    [
                        {
                            name: "{{ _("Cancel") }}",
                            hotkey: "escape"
                        },
                        {
                            name: "{{ _("Delete") }}",
                            hotkey: "return",
                            action: function()
                            {
                                window.location = '/categories/'+id+'/delete/';
                            }
                        }
                    ]
                });
        }
    </script>
    

    <p>
	    {% trans "Uncategorized transactions" %}: {{ unmatched_transactions|length }}
        <span class="button" onClick="$('#log').toggle();">{% trans "Show..." %}</span>
    </p>

    <div id="log" style="display:none;">
	    {% curia_include "money/transaction_list.html" transactions=unmatched_transactions %}
    </div>
    
    <p>
        <span class="button" onClick="delete_category({{ category.id }})"><img src="{{ MEDIA_URL }}commands/delete.png" alt=""/> {{ _("Delete this category") }}</span>
    </p>

    <form method="post">
        <table class="form">
            {{ form }}
            <tr><td></td><td><input type="submit" value="{% trans "Save" %}" class="button"/></td></tr>
        </table>
    </form>
    
    <script>
        $(window).load(function() {
            $('#id_matching_rules').keyup(highlight);
            highlight();
        });
    </script>
    
    <h3>{% trans "Transactions" %}</h3>
    {% include "money/transaction_list.html" %}
    {% digg_paginator %}
    
	{% if sum %}
    	<div>{% trans "Sum" %}: {{ sum }}</div>
	{% endif %}
{% endblock %}